SRCS_PLAT_gd32	= $(wildcard src/platform/gd32/*.c)

ISR_VECTOR_LENGTH_gd32	= 0x110
APP_POS_gd32		= 0x2C00
CSUM_POS_gd32		= $(ISR_VECTOR_LENGTH_gd32)
FEAT_POS_gd32		= 0x118
BOOT_FEAT_POS_gd32	= 0x124

CPPFLAGS_gd32	= -DGD32F1x0 -DGD32F130_150 -DMCU_TYPE=GD32 -DPRIVILEGES=0
CPPFLAGS_gd32	+= -DSYS_CORE_FREQ=72000000U
CPPFLAGS_gd32	+= -DAPPLICATION_OFFSET=$(APP_POS_gd32) -DISR_VECTOR_LENGTH=$(ISR_VECTOR_LENGTH_gd32)
CPPFLAGS_gd32	+= -Isrc/platform/gd32
CPPFLAGS_gd32	+= -Isrc/platform/gd32/cmsis
CPPFLAGS_gd32	+= -Isrc/platform/gd32/gd_lib/inc

# not enough space for poweroff & wakeup in GD32's bootloader
CPPFLAGS_app_gd32	= -DPOWEROFF_WAKEUP_ENABLED=1
CPPFLAGS_boot_gd32	= -DPOWEROFF_WAKEUP_ENABLED=0

CFLAGS_gd32	= -mcpu=cortex-m3 -mthumb -mlittle-endian

VARIANTS_gd32		= rev23 rev32
CPPFLAGS_gd32-rev23	= -DOMNIA_BOARD_REVISION=23 -DUSER_REGULATOR_ENABLED=0
CPPFLAGS_gd32-rev32	= -DOMNIA_BOARD_REVISION=32 -DUSER_REGULATOR_ENABLED=0

$(eval $(call PlatBuild,gd32))
